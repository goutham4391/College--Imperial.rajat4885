function getAssetUrl(){var env=getEnv(),ASSET_URL={local:"http://localhost/NewsAssets",dev:"//wwwdev.imperial.ac.uk/assets/news",test:"//wwwtest.imperial.ac.uk/assets/news",live:"//www.imperial.ac.uk/assets/news"},$url=ASSET_URL[env];return $url}function getAppUrl(){var APP_URL={local:"https://wwwdev.imperial.ac.uk/NewsApp/docs",dev:"https://wwwdev.imperial.ac.uk/NewsApp/docs",test:"https://wwwtest.imperial.ac.uk/NewsApp/docs",live:"https://www.imperial.ac.uk/NewsApp/docs"};return APP_URL[getEnv()]}function getEnv(){var domain=window.location.href.split("/")[2],envMap={localhost:"local","portdev.ad.ic.ac.uk":"dev","wwwdev.imperial.ac.uk":"dev","porttst.ad.ic.ac.uk":"test","wwwtest.imperial.ac.uk":"test","www.imperial.ac.uk":"live","www3.imperial.ac.uk":"live"};return"undefined"==typeof envMap[domain]?"live":envMap[domain]}function fetchpars(content_id){params.content=content_id,$.getJSON(APP_URL+"/state/load?jsonCallBack=?",params,function(r){if(PORTAL_URL=protocolAgnostic(r.portal),TOKEN=r.token,"local"!==getEnv()&&(ASSET_URL=protocolAgnostic(r.assets)),loadscripts(ASSET_URL+"/js",base_scripts),"undefined"!=typeof r.editor_scripts){editor_pars=r.editor_pars,$.each(editor_pars,function(key,value){console.log("editor_pars",key,value),editor_pars[key]=protocolAgnostic(editor_pars[key])});var editor_asset_url=editor_pars.editor_asset_url;editor_asset_url="/assets/news-landing-page-editor",loadscripts(editor_asset_url+"/js",r.editor_scripts),loadcss(editor_asset_url+"/css",r.editor_css)}$("input[name='token']").val(TOKEN)})}function protocolAgnostic(url){return url.replace("http://","//")}function loadscripts(base,scr){"undefined"!=typeof scr?$.each(scr,function(a,b){"object"==typeof b?$.getScript(base+"/"+b.main,function(){$.each(b.children,function(c,d){$.getScript(d)})}):$.getScript(base+"/"+b)}):$.getScript(base)}function loadcss(base,ss){var call=function(url){var _l=$("<link />");_l.attr("rel","stylesheet"),_l.attr("href",url),_l.attr("media","all"),$("head").append(_l)};"undefined"!=typeof ss?$.each(ss,function(a,b){call(base+"/"+b)}):call(base)}for(var ASSET_URL=getAssetUrl(),PORTAL_URL="",APP_URL=getAppUrl(),base_scripts=["service_functions.js",{main:"functions.js",children:[ASSET_URL+"/js/jquery.css3.js",ASSET_URL+"/js/sm.min.js"]}],editor_pars,TOKEN="",CP,pars=window.location.search.replace("?","").split("&"),params={},i=0;i<pars.length;i++){var tmparr=pars[i].split("=");params[tmparr[0]]=tmparr[1]}$.fn.globalJS=$.globalJS({loadSlideshow:!1,loadVideo:!0,loadImedia:!0,loadSlideshow2016:!1});